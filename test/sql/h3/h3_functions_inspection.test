# name: test/sql/h3/h3_functions_inspection.test
# group: [h3]

require h3

query I
SELECT h3_get_resolution(cast(586265647244115967 as ubigint));
----
2

query I
SELECT h3_get_resolution(cast(586265647244115967 as bigint));
----
2

query I
SELECT h3_get_resolution('822d57fffffffff');
----
2

query I
SELECT h3_get_index_digit('822d57fffffffff', 1);
----
5

query I
SELECT h3_get_index_digit('822d57fffffffff', 2);
----
2

query I
SELECT h3_get_index_digit('822d57fffffffff', -1);
----
NULL

query I
SELECT h3_get_index_digit('822d57fffffffff', 3);
----
7

query I
SELECT h3_get_index_digit('822d57fffffffff', 20);
----
NULL

query I
SELECT h3_is_valid_index(cast(586265647244115967 as ubigint));
----
true

query I
SELECT h3_is_valid_index(cast(586265647244115967 as bigint));
----
true

query I
SELECT h3_is_valid_index('85283473fffffff');
----
true

query I
SELECT h3_is_valid_index(cast(1234 as ubigint));
----
false

query I
SELECT h3_is_valid_index(cast(1234 as bigint));
----
false

query I
SELECT h3_is_valid_index('1234');
----
false

query I
SELECT h3_is_valid_index('115283473fffffff');
----
true

query I
SELECT h3_is_valid_cell(cast(586265647244115967 as ubigint));
----
true

query I
SELECT h3_is_valid_cell(cast(586265647244115967 as bigint));
----
true

query I
SELECT h3_is_valid_cell('85283473fffffff');
----
true

query I
SELECT h3_is_valid_cell(cast(1234 as ubigint));
----
false

query I
SELECT h3_is_valid_cell(cast(1234 as bigint));
----
false

query I
SELECT h3_is_valid_cell('1234');
----
false

query I
SELECT h3_is_valid_cell('115283473fffffff');
----
false

query I
SELECT h3_string_to_h3(',,,,,')
----
NULL

query II
SELECT h3_h3_to_string(cast(10000000000000000 as ubigint)), h3_h3_to_string(cast(1 as ubigint))
----
2386f26fc10000	1

query II
SELECT h3_h3_to_string(cast(10000000000000000 as bigint)), h3_h3_to_string(cast(1 as bigint))
----
2386f26fc10000	1

query II
select h3_get_icosahedron_faces(599686042433355775::ubigint), h3_get_icosahedron_faces(576988517884755967::ubigint)
----
[7]	[1, 6, 11, 7, 2]

query II
select h3_get_icosahedron_faces(599686042433355775::bigint), h3_get_icosahedron_faces(576988517884755967::bigint)
----
[7]	[1, 6, 11, 7, 2]

query II
select h3_get_icosahedron_faces('85283473fffffff'), h3_get_icosahedron_faces('801dfffffffffff')
----
[7]	[1, 6, 11, 7, 2]

query I
select h3_get_icosahedron_faces(18446744073709551615::ubigint)
----
NULL

query I
select h3_get_icosahedron_faces(9223372036854775807::bigint)
----
NULL

query I
select h3_get_icosahedron_faces('7fffffffffffffff')
----
NULL

query I
select h3_construct_cell(0, 0, [])
----
576495936675512319

query I
select h3_construct_cell(-1, 0, [])
----
NULL

query I
select h3_construct_cell(0, -1, [])
----
NULL

query I
select h3_construct_cell(1, 5, [])
----
NULL

query I
select h3_construct_cell(1, 5, [1, 2])
----
NULL

query I
select h3_construct_cell(1, 5, [1])
----
581149069884260351

query I
select h3_construct_cell(1, 4, [1])
----
NULL

query I
select h3_construct_cell_string(0, 0, [])
----
8001fffffffffff

query I
select h3_construct_cell_string(-1, 0, [])
----
NULL

query I
select h3_construct_cell_string(0, -1, [])
----
NULL

query I
select h3_construct_cell_string(1, 5, [])
----
NULL

query I
select h3_construct_cell_string(1, 5, [1, 2])
----
NULL

query I
select h3_construct_cell_string(1, 5, [1])
----
810a7ffffffffff

query I
select h3_construct_cell_string(1, 4, [1])
----
NULL

query I
select h3_construct_cell_string(7, 20, [1, 2, 3, 4, 5, 6])
----
NULL

query I
select h3_construct_cell_string(15, 100, [1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3])
----
8fc8539714e5c53

query I
select h3_construct_cell_string(15, 100, [1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4])
----
NULL
