# name: test/sql/h3/h3_functions_misc.test
# group: [h3]

require h3

query I
SELECT h3_get_hexagon_area_avg(0, 'km^2');
----
4357449.416078383

query I
SELECT h3_get_hexagon_area_avg(1, 'km^2');
----
609788.4417941332

query I
SELECT h3_get_hexagon_area_avg(-1, 'km^2');
----
NULL

query I
SELECT h3_get_hexagon_area_avg(0, 'm^2');
----
4357449416078.39

query I
SELECT h3_get_hexagon_area_avg(1, 'm^2');
----
609788441794.1339

query I
SELECT h3_get_hexagon_area_avg(-1, 'm^2');
----
NULL

query I
SELECT h3_cell_area('8928308280fffff', 'km^2')
----
0.1093981886464832

query I
SELECT h3_cell_area('8928308280fffff', 'm^2')
----
109398.18864648319

query I
SELECT h3_cell_area(cast(586265647244115967 as ubigint), 'km^2')
----
85321.69572540345

query I
SELECT h3_cell_area(cast(586265647244115967 as bigint), 'km^2')
----
85321.69572540345

query I
SELECT h3_cell_area('fffffffffffffff', 'km^2')
----
NULL

query I
SELECT h3_cell_area('8928308280fffff', 'km')
----
NULL

query I
SELECT h3_edge_length('115283473fffffff', 'km')
----
10.294736086198531

query I
SELECT h3_edge_length('115283473fffffff', 'm')
----
10294.73608619853

query I
SELECT h3_edge_length(cast(1608492358964346879 as ubigint), 'km')
----
10.302930275179133

query I
SELECT h3_edge_length(cast(1608492358964346879 as bigint), 'km')
----
10.302930275179133

query I
SELECT h3_edge_length('fffffffffffffff', 'km')
----
NULL

query I
SELECT h3_edge_length('115283473fffffff', 'km^2')
----
NULL

query I
SELECT h3_get_num_cells(0)
----
122

query I
SELECT h3_get_num_cells(5)
----
2016842

query I
SELECT h3_get_num_cells(-1)
----
NULL

query I
SELECT h3_get_res0_cells()
----
[576495936675512319, 576531121047601151, 576566305419689983, 576601489791778815, 576636674163867647, 576671858535956479, 576707042908045311, 576742227280134143, 576777411652222975, 576812596024311807, 576847780396400639, 576882964768489471, 576918149140578303, 576953333512667135, 576988517884755967, 577023702256844799, 577058886628933631, 577094071001022463, 577129255373111295, 577164439745200127, 577199624117288959, 577234808489377791, 577269992861466623, 577305177233555455, 577340361605644287, 577375545977733119, 577410730349821951, 577445914721910783, 577481099093999615, 577516283466088447, 577551467838177279, 577586652210266111, 577621836582354943, 577657020954443775, 577692205326532607, 577727389698621439, 577762574070710271, 577797758442799103, 577832942814887935, 577868127186976767, 577903311559065599, 577938495931154431, 577973680303243263, 578008864675332095, 578044049047420927, 578079233419509759, 578114417791598591, 578149602163687423, 578184786535776255, 578219970907865087, 578255155279953919, 578290339652042751, 578325524024131583, 578360708396220415, 578395892768309247, 578431077140398079, 578466261512486911, 578501445884575743, 578536630256664575, 578571814628753407, 578606999000842239, 578642183372931071, 578677367745019903, 578712552117108735, 578747736489197567, 578782920861286399, 578818105233375231, 578853289605464063, 578888473977552895, 578923658349641727, 578958842721730559, 578994027093819391, 579029211465908223, 579064395837997055, 579099580210085887, 579134764582174719, 579169948954263551, 579205133326352383, 579240317698441215, 579275502070530047, 579310686442618879, 579345870814707711, 579381055186796543, 579416239558885375, 579451423930974207, 579486608303063039, 579521792675151871, 579556977047240703, 579592161419329535, 579627345791418367, 579662530163507199, 579697714535596031, 579732898907684863, 579768083279773695, 579803267651862527, 579838452023951359, 579873636396040191, 579908820768129023, 579944005140217855, 579979189512306687, 580014373884395519, 580049558256484351, 580084742628573183, 580119927000662015, 580155111372750847, 580190295744839679, 580225480116928511, 580260664489017343, 580295848861106175, 580331033233195007, 580366217605283839, 580401401977372671, 580436586349461503, 580471770721550335, 580506955093639167, 580542139465727999, 580577323837816831, 580612508209905663, 580647692581994495, 580682876954083327, 580718061326172159, 580753245698260991]

query I
SELECT h3_get_res0_cells_string()
----
[8001fffffffffff, 8003fffffffffff, 8005fffffffffff, 8007fffffffffff, 8009fffffffffff, 800bfffffffffff, 800dfffffffffff, 800ffffffffffff, 8011fffffffffff, 8013fffffffffff, 8015fffffffffff, 8017fffffffffff, 8019fffffffffff, 801bfffffffffff, 801dfffffffffff, 801ffffffffffff, 8021fffffffffff, 8023fffffffffff, 8025fffffffffff, 8027fffffffffff, 8029fffffffffff, 802bfffffffffff, 802dfffffffffff, 802ffffffffffff, 8031fffffffffff, 8033fffffffffff, 8035fffffffffff, 8037fffffffffff, 8039fffffffffff, 803bfffffffffff, 803dfffffffffff, 803ffffffffffff, 8041fffffffffff, 8043fffffffffff, 8045fffffffffff, 8047fffffffffff, 8049fffffffffff, 804bfffffffffff, 804dfffffffffff, 804ffffffffffff, 8051fffffffffff, 8053fffffffffff, 8055fffffffffff, 8057fffffffffff, 8059fffffffffff, 805bfffffffffff, 805dfffffffffff, 805ffffffffffff, 8061fffffffffff, 8063fffffffffff, 8065fffffffffff, 8067fffffffffff, 8069fffffffffff, 806bfffffffffff, 806dfffffffffff, 806ffffffffffff, 8071fffffffffff, 8073fffffffffff, 8075fffffffffff, 8077fffffffffff, 8079fffffffffff, 807bfffffffffff, 807dfffffffffff, 807ffffffffffff, 8081fffffffffff, 8083fffffffffff, 8085fffffffffff, 8087fffffffffff, 8089fffffffffff, 808bfffffffffff, 808dfffffffffff, 808ffffffffffff, 8091fffffffffff, 8093fffffffffff, 8095fffffffffff, 8097fffffffffff, 8099fffffffffff, 809bfffffffffff, 809dfffffffffff, 809ffffffffffff, 80a1fffffffffff, 80a3fffffffffff, 80a5fffffffffff, 80a7fffffffffff, 80a9fffffffffff, 80abfffffffffff, 80adfffffffffff, 80affffffffffff, 80b1fffffffffff, 80b3fffffffffff, 80b5fffffffffff, 80b7fffffffffff, 80b9fffffffffff, 80bbfffffffffff, 80bdfffffffffff, 80bffffffffffff, 80c1fffffffffff, 80c3fffffffffff, 80c5fffffffffff, 80c7fffffffffff, 80c9fffffffffff, 80cbfffffffffff, 80cdfffffffffff, 80cffffffffffff, 80d1fffffffffff, 80d3fffffffffff, 80d5fffffffffff, 80d7fffffffffff, 80d9fffffffffff, 80dbfffffffffff, 80ddfffffffffff, 80dffffffffffff, 80e1fffffffffff, 80e3fffffffffff, 80e5fffffffffff, 80e7fffffffffff, 80e9fffffffffff, 80ebfffffffffff, 80edfffffffffff, 80effffffffffff, 80f1fffffffffff, 80f3fffffffffff]

query I
SELECT h3_get_pentagons(-1)
----
NULL

query I
SELECT h3_get_pentagons(16)
----
NULL

query I
SELECT h3_get_pentagons(0)
----
[576636674163867647, 576988517884755967, 577340361605644287, 577832942814887935, 578219970907865087, 578536630256664575, 578712552117108735, 579029211465908223, 579416239558885375, 579908820768129023, 580260664489017343, 580612508209905663]

query I
SELECT h3_get_pentagons(5)
----
[599119489002373119, 599471332723261439, 599823176444149759, 600315757653393407, 600702785746370559, 601019445095170047, 601195366955614207, 601512026304413695, 601899054397390847, 602391635606634495, 602743479327522815, 603095323048411135]

query I
SELECT h3_get_pentagons_string(-1)
----
NULL

query I
SELECT h3_get_pentagons_string(16)
----
NULL

query I
SELECT h3_get_pentagons_string(0)
----
[8009fffffffffff, 801dfffffffffff, 8031fffffffffff, 804dfffffffffff, 8063fffffffffff, 8075fffffffffff, 807ffffffffffff, 8091fffffffffff, 80a7fffffffffff, 80c3fffffffffff, 80d7fffffffffff, 80ebfffffffffff]

query I
SELECT h3_get_pentagons_string(5)
----
[85080003fffffff, 851c0003fffffff, 85300003fffffff, 854c0003fffffff, 85620003fffffff, 85740003fffffff, 857e0003fffffff, 85900003fffffff, 85a60003fffffff, 85c20003fffffff, 85d60003fffffff, 85ea0003fffffff]

query I
SELECT h3_great_circle_distance(5, 5, 5, 5, 'km')
----
0

query I
SELECT h3_great_circle_distance(5, 5, 15, 15, 'rads')
----
0.2447868223787244

query I
SELECT h3_great_circle_distance(5, 5, 15, 15, 'km')
----
1559.5386031690684

query I
SELECT h3_great_circle_distance(5, 5, -15, -15, 'm')
----
3130865.2809374747

query I
SELECT h3_great_circle_distance(5, 5, -15, -15, 'invalid')
----
NULL

query I
SELECT h3_great_circle_distance(5, 5, -15, -15, NULL)
----
NULL
