# name: test/sql/h3/h3_functions_regions_wkb.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([586265647244115967::ubigint, 586260699441790975::ubigint, 586244756523188223::ubigint, 586245306279002111::ubigint, 586266196999929855::ubigint, 586264547732488191::ubigint, 586267846267371519::ubigint]))
----
GEOMETRYCOLLECTION (POLYGON ((35.40306896671758 42.817984971221726, 36.62670018676324 41.3634074805156, 38.856462963835455 41.330674023031456, 39.97757007195358 39.84548333301932, 42.116516107519395 39.762213320715894, 43.20483211516571 41.142598767635725, 45.33379907578726 41.01652619717039, 46.52152478353461 42.402509861510936, 45.504838818168665 43.94551864497396, 46.76525433398213 45.359443101313495, 45.69576371629002 46.90573252004867, 43.31814421137 46.98312969411602, 42.14199037111349 48.47061815031069, 39.76090151170153 48.458994691962985, 38.69290600551895 46.99245950350819, 36.29910581928564 47.05631421186065, 35.19778921516827 45.672384772481486, 36.4686633111119 44.24764844687383, 35.40306896671758 42.817984971221726)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([586265647244115967::bigint, 586260699441790975::bigint, 586244756523188223::bigint, 586245306279002111::bigint, 586266196999929855::bigint, 586264547732488191::bigint, 586267846267371519::bigint]))
----
GEOMETRYCOLLECTION (POLYGON ((35.40306896671758 42.817984971221726, 36.62670018676324 41.3634074805156, 38.856462963835455 41.330674023031456, 39.97757007195358 39.84548333301932, 42.116516107519395 39.762213320715894, 43.20483211516571 41.142598767635725, 45.33379907578726 41.01652619717039, 46.52152478353461 42.402509861510936, 45.504838818168665 43.94551864497396, 46.76525433398213 45.359443101313495, 45.69576371629002 46.90573252004867, 43.31814421137 46.98312969411602, 42.14199037111349 48.47061815031069, 39.76090151170153 48.458994691962985, 38.69290600551895 46.99245950350819, 36.29910581928564 47.05631421186065, 35.19778921516827 45.672384772481486, 36.4686633111119 44.24764844687383, 35.40306896671758 42.817984971221726)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb(['8548ebb3fffffff','8548eb8ffffffff','8548ebbbfffffff','8548eb97fffffff','8548e94bfffffff','8548eb83fffffff','8548ebc3fffffff']))
----
GEOMETRYCOLLECTION (POLYGON ((-111.82463766850755 33.24932913365275, -111.88513105896519 33.16808243627076, -111.83094668081874 33.084633005899214, -111.8913478361154 33.003321571267826, -111.83723747014606 32.91979576116519, -111.72280014834611 32.91753164625474, -111.66883788254948 32.83388073168828, -111.55445828974302 32.83145394628534, -111.49387556488782 32.91268913716742, -111.37939012373894 32.910110678768206, -111.31862571005111 32.99124276452646, -111.37243541085846 33.07499204029521, -111.31157783977149 33.15605863933407, -111.36546055903808 33.239732067177584, -111.48027841697767 33.24229022657837, -111.53431184067215 33.32583812164212, -111.64919010341183 33.32823190092791, -111.7098678899662 33.24708872704796, -111.82463766850755 33.24932913365275), (-111.71634337033196 33.08238077296994, -111.65575831879912 33.16358980146015, -111.54104675871832 33.161185074677135, -111.48708682110914 33.077560322608655, -111.54776221372092 32.99638949897361, -111.66230755117635 32.998805228045974, -111.71634337033196 33.08238077296994)), POLYGON ((-110.8524825064444 33.144537120081395, -110.96727372967737 33.14757613396258, -111.02839962369785 33.06665463913938, -110.97482008789896 32.98273407855841, -110.86019497530295 32.979687476997704, -110.79898363664479 33.06056903249352, -110.8524825064444 33.144537120081395)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb(split('8548ebb3fffffff,8548eb8ffffffff,8548ebbbfffffff,8548eb97fffffff,8548e94bfffffff,8548eb83fffffff,8548eb9bfffffff,8548ebd7fffffff,8548eb13fffffff,8548ebc7fffffff,8548eb53fffffff,8548ebcbfffffff,8548ea27fffffff,8548ea23fffffff,8548ea33fffffff,8548eaaffffffff', ',')))
----
GEOMETRYCOLLECTION (POLYGON ((-111.72280014834611 32.91753164625474, -111.66883788254948 32.83388073168828, -111.55445828974302 32.83145394628534, -111.49387556488782 32.91268913716742, -111.37939012373894 32.910110678768206, -111.32565324623158 32.82628680711324, -111.21122961426718 32.82354639845344, -111.15037749937001 32.904639216274575, -111.03585214087302 32.90174616603116, -110.97482008789896 32.98273407855841, -111.02839962369785 33.06665463913938, -110.96727372967737 33.14757613396258, -111.02092553375353 33.231421623086604, -111.13578319705678 33.23429778905235, -111.18958735926927 33.318019357619626, -111.30450954722431 33.320731878335586, -111.36546055903808 33.239732067177584, -111.48027841697767 33.24229022657837, -111.53431184067215 33.32583812164212, -111.64919010341183 33.32823190092791, -111.7098678899662 33.24708872704796, -111.82463766850755 33.24932913365275, -111.88513105896519 33.16808243627076, -111.83094668081874 33.084633005899214, -111.8913478361154 33.003321571267826, -111.83723747014606 32.91979576116519, -111.72280014834611 32.91753164625474), (-111.65575831879912 33.16358980146015, -111.54104675871832 33.161185074677135, -111.48708682110914 33.077560322608655, -111.54776221372092 32.99638949897361, -111.66230755117635 32.998805228045974, -111.71634337033196 33.08238077296994, -111.65575831879912 33.16358980146015), (-111.37243541085846 33.07499204029521, -111.31157783977149 33.15605863933407, -111.19682231560797 33.15333687467585, -111.14309089579902 33.06953922190927, -111.2040363705352 32.98851170365504, -111.31862571005111 32.99124276452646, -111.37243541085846 33.07499204029521)), POLYGON ((-110.49981780105215 33.299511343137105, -110.61480292020083 33.30286190521649, -110.66829148231326 33.38680143049488, -110.78334743669788 33.38998911458275, -110.84474770089349 33.30924392335347, -110.7911768488962 33.22535114217554, -110.8524825064444 33.144537120081395, -110.79898363664479 33.06056903249352, -110.68426075783464 33.057367980166006, -110.6228707998085 33.1381417335997, -110.50805215797833 33.13478534150049, -110.45478982353582 33.05064932922883, -110.51626274664483 32.9699163559814, -110.63091538789439 32.973278625268854, -110.69221084093714 32.89243752585983, -110.63893678485933 32.808275137321885, -110.52444966947729 32.804906944262456, -110.46307143158357 32.88570707385641, -110.3484909096718 32.88218442099277, -110.28693635600375 32.962876105574246, -110.34004360683124 33.04713172046208, -110.27839390426105 33.12775513379022, -110.33157187433808 33.21193724444969, -110.44648426083113 33.215449854722195, -110.49981780105215 33.299511343137105)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb(split('zero', ',')))
----
GEOMETRYCOLLECTION (POLYGON ((94.14309010184776 76.163042830191, 145.5581976913369 87.36469532319619, -34.75841798028471 81.27137179020501, 0.32561035194326 73.31022368544396, 31.831280499087427 68.92995788193983, 62.345344956509784 69.3935964899183, 94.14309010184776 76.163042830191)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([NULL]::ubigint[]))
----
GEOMETRYCOLLECTION (POLYGON ((94.14309010184776 76.163042830191, 145.5581976913369 87.36469532319619, -34.75841798028471 81.27137179020501, 0.32561035194326 73.31022368544396, 31.831280499087427 68.92995788193983, 62.345344956509784 69.3935964899183, 94.14309010184776 76.163042830191)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([NULL]::bigint[]))
----
GEOMETRYCOLLECTION (POLYGON ((94.14309010184776 76.163042830191, 145.5581976913369 87.36469532319619, -34.75841798028471 81.27137179020501, 0.32561035194326 73.31022368544396, 31.831280499087427 68.92995788193983, 62.345344956509784 69.3935964899183, 94.14309010184776 76.163042830191)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([0]::ubigint[]))
----
GEOMETRYCOLLECTION (POLYGON ((94.14309010184776 76.163042830191, 145.5581976913369 87.36469532319619, -34.75841798028471 81.27137179020501, 0.32561035194326 73.31022368544396, 31.831280499087427 68.92995788193983, 62.345344956509784 69.3935964899183, 94.14309010184776 76.163042830191)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([0]::bigint[]))
----
GEOMETRYCOLLECTION (POLYGON ((94.14309010184776 76.163042830191, 145.5581976913369 87.36469532319619, -34.75841798028471 81.27137179020501, 0.32561035194326 73.31022368544396, 31.831280499087427 68.92995788193983, 62.345344956509784 69.3935964899183, 94.14309010184776 76.163042830191)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([]::ubigint[]))
----
GEOMETRYCOLLECTION EMPTY

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([]::bigint[]))
----
GEOMETRYCOLLECTION EMPTY
