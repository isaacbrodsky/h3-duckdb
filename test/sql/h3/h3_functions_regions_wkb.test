# name: test/sql/h3/h3_functions_regions_wkb.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([586265647244115967::ubigint, 586260699441790975::ubigint, 586244756523188223::ubigint, 586245306279002111::ubigint, 586266196999929855::ubigint, 586264547732488191::ubigint, 586267846267371519::ubigint])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((36.468663311112 44.247648446874, 35.197789215168 45.672384772481, 36.299105819286 47.056314211861, 38.692906005519 46.992459503508, 39.760901511702 48.458994691963, 42.141990371113 48.470618150311, 43.31814421137 46.983129694116, 45.69576371629 46.905732520049, 46.765254333982 45.359443101313, 45.504838818169 43.945518644974, 46.521524783535 42.402509861511, 45.333799075787 41.01652619717, 43.204832115166 41.142598767636, 42.116516107519 39.762213320716, 39.977570071954 39.845483333019, 38.856462963835 41.330674023031, 36.626700186763 41.363407480516, 35.403068966718 42.817984971222, 36.468663311112 44.247648446874)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([586265647244115967::bigint, 586260699441790975::bigint, 586244756523188223::bigint, 586245306279002111::bigint, 586266196999929855::bigint, 586264547732488191::bigint, 586267846267371519::bigint])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((36.468663311112 44.247648446874, 35.197789215168 45.672384772481, 36.299105819286 47.056314211861, 38.692906005519 46.992459503508, 39.760901511702 48.458994691963, 42.141990371113 48.470618150311, 43.31814421137 46.983129694116, 45.69576371629 46.905732520049, 46.765254333982 45.359443101313, 45.504838818169 43.945518644974, 46.521524783535 42.402509861511, 45.333799075787 41.01652619717, 43.204832115166 41.142598767636, 42.116516107519 39.762213320716, 39.977570071954 39.845483333019, 38.856462963835 41.330674023031, 36.626700186763 41.363407480516, 35.403068966718 42.817984971222, 36.468663311112 44.247648446874)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb(['8548ebb3fffffff','8548eb8ffffffff','8548ebbbfffffff','8548eb97fffffff','8548e94bfffffff','8548eb83fffffff','8548ebc3fffffff'])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((-111.709867889966 33.247088727048, -111.649190103412 33.328231900928, -111.534311840672 33.325838121642, -111.480278416978 33.242290226578, -111.365460559038 33.239732067178, -111.311577839771 33.156058639334, -111.372435410858 33.074992040295, -111.318625710051 32.991242764526, -111.379390123739 32.910110678768, -111.493875564888 32.912689137167, -111.554458289743 32.831453946285, -111.668837882549 32.833880731688, -111.722800148346 32.917531646255, -111.837237470146 32.919795761165, -111.891347836115 33.003321571268, -111.830946680819 33.084633005899, -111.885131058965 33.168082436271, -111.824637668508 33.249329133653, -111.709867889966 33.247088727048), (-111.662307551176 32.998805228046, -111.547762213721 32.996389498974, -111.487086821109 33.077560322609, -111.541046758718 33.161185074677, -111.655758318799 33.16358980146, -111.716343370332 33.08238077297, -111.662307551176 32.998805228046)), POLYGON ((-110.798983636645 33.060569032494, -110.860194975303 32.979687476998, -110.974820087899 32.982734078558, -111.028399623698 33.066654639139, -110.967273729677 33.147576133963, -110.852482506444 33.144537120081, -110.798983636645 33.060569032494)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb(split('8548ebb3fffffff,8548eb8ffffffff,8548ebbbfffffff,8548eb97fffffff,8548e94bfffffff,8548eb83fffffff,8548eb9bfffffff,8548ebd7fffffff,8548eb13fffffff,8548ebc7fffffff,8548eb53fffffff,8548ebcbfffffff,8548ea27fffffff,8548ea23fffffff,8548ea33fffffff,8548eaaffffffff', ','))), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((-111.837237470146 32.919795761165, -111.891347836115 33.003321571268, -111.830946680819 33.084633005899, -111.885131058965 33.168082436271, -111.824637668508 33.249329133653, -111.709867889966 33.247088727048, -111.649190103412 33.328231900928, -111.534311840672 33.325838121642, -111.480278416978 33.242290226578, -111.365460559038 33.239732067178, -111.304509547224 33.320731878336, -111.189587359269 33.31801935762, -111.135783197057 33.234297789052, -111.020925533754 33.231421623087, -110.967273729677 33.147576133963, -111.028399623698 33.066654639139, -110.974820087899 32.982734078558, -111.035852140873 32.901746166031, -111.15037749937 32.904639216275, -111.211229614267 32.823546398453, -111.325653246232 32.826286807113, -111.379390123739 32.910110678768, -111.493875564888 32.912689137167, -111.554458289743 32.831453946285, -111.668837882549 32.833880731688, -111.722800148346 32.917531646255, -111.837237470146 32.919795761165), (-111.716343370332 33.08238077297, -111.662307551176 32.998805228046, -111.547762213721 32.996389498974, -111.487086821109 33.077560322609, -111.541046758718 33.161185074677, -111.655758318799 33.16358980146, -111.716343370332 33.08238077297), (-111.318625710051 32.991242764526, -111.204036370535 32.988511703655, -111.143090895799 33.069539221909, -111.196822315608 33.153336874676, -111.311577839771 33.156058639334, -111.372435410858 33.074992040295, -111.318625710051 32.991242764526)), POLYGON ((-110.446484260831 33.215449854722, -110.331571874338 33.21193724445, -110.278393904261 33.12775513379, -110.340043606831 33.047131720462, -110.286936356004 32.962876105574, -110.348490909672 32.882184420993, -110.463071431584 32.885707073856, -110.524449669477 32.804906944262, -110.638936784859 32.808275137322, -110.692210840937 32.89243752586, -110.630915387894 32.973278625269, -110.516262746645 32.969916355981, -110.454789823536 33.050649329229, -110.508052157978 33.1347853415, -110.622870799808 33.1381417336, -110.684260757835 33.057367980166, -110.798983636645 33.060569032494, -110.852482506444 33.144537120081, -110.791176848896 33.225351142176, -110.844747700893 33.309243923353, -110.783347436698 33.389989114583, -110.668291482313 33.386801430495, -110.614802920201 33.302861905216, -110.499817801052 33.299511343137, -110.446484260831 33.215449854722)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb(split('zero', ','))), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((62.34534495651 69.393596489918, 31.831280499087 68.92995788194, 0.325610351943 73.310223685444, -34.758417980285 81.271371790205, 145.558197691337 87.364695323196, 94.143090101848 76.163042830191, 62.34534495651 69.393596489918)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([NULL]::ubigint[])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((62.34534495651 69.393596489918, 31.831280499087 68.92995788194, 0.325610351943 73.310223685444, -34.758417980285 81.271371790205, 145.558197691337 87.364695323196, 94.143090101848 76.163042830191, 62.34534495651 69.393596489918)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([NULL]::bigint[])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((62.34534495651 69.393596489918, 31.831280499087 68.92995788194, 0.325610351943 73.310223685444, -34.758417980285 81.271371790205, 145.558197691337 87.364695323196, 94.143090101848 76.163042830191, 62.34534495651 69.393596489918)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([0]::ubigint[])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((62.34534495651 69.393596489918, 31.831280499087 68.92995788194, 0.325610351943 73.310223685444, -34.758417980285 81.271371790205, 145.558197691337 87.364695323196, 94.143090101848 76.163042830191, 62.34534495651 69.393596489918)))

query I
select ST_ReducePrecision(st_geomfromwkb(h3_cells_to_multi_polygon_wkb([0]::bigint[])), 0.000000000001)
----
GEOMETRYCOLLECTION (POLYGON ((62.34534495651 69.393596489918, 31.831280499087 68.92995788194, 0.325610351943 73.310223685444, -34.758417980285 81.271371790205, 145.558197691337 87.364695323196, 94.143090101848 76.163042830191, 62.34534495651 69.393596489918)))

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([]::ubigint[]))
----
GEOMETRYCOLLECTION EMPTY

query I
select st_geomfromwkb(h3_cells_to_multi_polygon_wkb([]::bigint[]))
----
GEOMETRYCOLLECTION EMPTY
