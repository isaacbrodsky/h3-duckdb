# name: test/sql/h3/h3_functions_indexing_wkb.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
SELECT st_geomfromwkb(h3_cell_to_boundary_wkb(h3_string_to_h3('822d57fffffffff')));
----
POLYGON ((38.77754619105016 44.19857132247734, 39.938746033838626 42.73629845548312, 42.1506736379015 42.63127069249239, 43.258394559924994 44.04754241934246, 42.14657468326134 45.5395051722763, 39.89716674041971 45.5595774995064, 38.77754619105016 44.19857132247734))

query I
SELECT st_geomfromwkb(h3_cell_to_boundary_wkb(cast(h3_string_to_h3('822d57fffffffff') as bigint)));
----
POLYGON ((38.77754619105016 44.19857132247734, 39.938746033838626 42.73629845548312, 42.1506736379015 42.63127069249239, 43.258394559924994 44.04754241934246, 42.14657468326134 45.5395051722763, 39.89716674041971 45.5595774995064, 38.77754619105016 44.19857132247734))

query I
SELECT h3_cell_to_boundary_wkb(h3_string_to_h3('fffffffffffffff'));
----
NULL

query I
SELECT st_geomfromwkb(h3_cell_to_boundary_wkb('822d57fffffffff'));
----
POLYGON ((38.77754619105016 44.19857132247734, 39.938746033838626 42.73629845548312, 42.1506736379015 42.63127069249239, 43.258394559924994 44.04754241934246, 42.14657468326134 45.5395051722763, 39.89716674041971 45.5595774995064, 38.77754619105016 44.19857132247734))

query I
SELECT h3_cell_to_boundary_wkb('zzz');
----
NULL
