# name: test/sql/h3/h3_functions_indexing_wkb.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb(h3_string_to_h3('822d57fffffffff'))), 0.0000000000001);
----
POLYGON ((39.8971667404197 45.5595774995064, 42.1465746832613 45.5395051722763, 43.258394559925 44.0475424193425, 42.1506736379015 42.6312706924924, 39.9387460338386 42.7362984554831, 38.7775461910502 44.1985713224773, 39.8971667404197 45.5595774995064))

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb(cast(h3_string_to_h3('822d57fffffffff') as bigint))), 0.0000000000001);
----
POLYGON ((39.8971667404197 45.5595774995064, 42.1465746832613 45.5395051722763, 43.258394559925 44.0475424193425, 42.1506736379015 42.6312706924924, 39.9387460338386 42.7362984554831, 38.7775461910502 44.1985713224773, 39.8971667404197 45.5595774995064))

query I
SELECT h3_cell_to_boundary_wkb(h3_string_to_h3('fffffffffffffff'));
----
NULL

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb('822d57fffffffff')), 0.0000000000001);
----
POLYGON ((39.8971667404197 45.5595774995064, 42.1465746832613 45.5395051722763, 43.258394559925 44.0475424193425, 42.1506736379015 42.6312706924924, 39.9387460338386 42.7362984554831, 38.7775461910502 44.1985713224773, 39.8971667404197 45.5595774995064))

query I
SELECT h3_cell_to_boundary_wkb('zzz');
----
NULL
