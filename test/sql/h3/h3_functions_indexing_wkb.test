# name: test/sql/h3/h3_functions_indexing_wkb.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb(h3_string_to_h3('822d57fffffffff'))), 0.000000000001);
----
POLYGON ((39.89716674042 45.559577499506, 42.146574683261 45.539505172276, 43.258394559925 44.047542419342, 42.150673637902 42.631270692492, 39.938746033839 42.736298455483, 38.77754619105 44.198571322477, 39.89716674042 45.559577499506))

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb(cast(h3_string_to_h3('822d57fffffffff') as bigint))), 0.000000000001);
----
POLYGON ((39.89716674042 45.559577499506, 42.146574683261 45.539505172276, 43.258394559925 44.047542419342, 42.150673637902 42.631270692492, 39.938746033839 42.736298455483, 38.77754619105 44.198571322477, 39.89716674042 45.559577499506))

query I
SELECT h3_cell_to_boundary_wkb(h3_string_to_h3('fffffffffffffff'));
----
NULL

query I
SELECT ST_ReducePrecision(st_geomfromwkb(h3_cell_to_boundary_wkb('822d57fffffffff')), 0.000000000001);
----
POLYGON ((39.89716674042 45.559577499506, 42.146574683261 45.539505172276, 43.258394559925 44.047542419342, 42.150673637902 42.631270692492, 39.938746033839 42.736298455483, 38.77754619105 44.198571322477, 39.89716674042 45.559577499506))

query I
SELECT h3_cell_to_boundary_wkb('zzz');
----
NULL
