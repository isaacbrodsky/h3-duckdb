# name: test/sql/h3/h3_functions_regions_wkb_to_cells.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlap')
----
[599685771850416127, 599685772924157951, 599685776145383423, 599685777219125247]

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlapaaa')
----
[]

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 50, 'overlap')
----
[]

statement error
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POINT (-122.53401215374411 37.81666158907579)')), 5, 'overlap')
----
Invalid Input Error: Invalid WKB: expected polygon at 5

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlap')
----
[85283083fffffff, 85283087fffffff, 85283093fffffff, 85283097fffffff]

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlapaaa')
----
[]

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 50, 'overlap')
----
[]

statement error
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POINT (-122.53401215374411 37.81666158907579)')), 5, 'overlap')
----
Invalid Input Error: Invalid WKB: expected polygon at 5
