# name: test/sql/h3/h3_functions_regions_wkb_to_cells.test
# group: [h3]

require h3

statement ok
install spatial

statement ok
load spatial

query I
select length(h3_polygon_wkb_to_cells(st_aswkb(st_geomfromtext('POLYGON ((-122.40898669969356 37.81331899988944, -122.38054369969613 37.78663019990699, -122.35447369969584 37.719806199904276, -122.51234369969448 37.70761319990403, -122.52471869969825 37.783587199903444, -122.47987669969707 37.81515719990604, -122.40898669969356 37.81331899988944),(-122.44711969969569 37.786980199908015, -122.45907769969834 37.76641019990431, -122.41370969969519 37.77106819990672))')), 9));
----
1214

query I
select length(h3_polygon_wkb_to_cells_string(st_aswkb(st_geomfromtext('POLYGON ((-122.40898669969356 37.81331899988944, -122.38054369969613 37.78663019990699, -122.35447369969584 37.719806199904276, -122.51234369969448 37.70761319990403, -122.52471869969825 37.783587199903444, -122.47987669969707 37.81515719990604, -122.40898669969356 37.81331899988944),(-122.44711969969569 37.786980199908015, -122.45907769969834 37.76641019990431, -122.41370969969519 37.77106819990672))')), 9));
----
1214

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlap')
----
[599685771850416127, 599685772924157951, 599685776145383423, 599685777219125247]

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlapaaa')
----
[]

query I
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 50, 'overlap')
----
[]

statement error
select h3_polygon_wkb_to_cells_experimental(st_aswkb(st_geomfromtext('POINT (-122.53401215374411 37.81666158907579)')), 5, 'overlap')
----
Invalid Input Error: Invalid WKB: expected polygon at 5

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlap')
----
[85283083fffffff, 85283087fffffff, 85283093fffffff, 85283097fffffff]

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 5, 'overlapaaa')
----
[]

query I
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POLYGON ((-122.53401215374411 37.81666158907579, -122.53401215374411 37.70454536656959, -122.3479361380842 37.70454536656959, -122.3479361380842 37.81666158907579, -122.53401215374411 37.81666158907579))')), 50, 'overlap')
----
[]

statement error
select h3_polygon_wkb_to_cells_experimental_string(st_aswkb(st_geomfromtext('POINT (-122.53401215374411 37.81666158907579)')), 5, 'overlap')
----
Invalid Input Error: Invalid WKB: expected polygon at 5
